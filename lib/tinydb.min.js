!function r(o,i,u){function s(n,e){if(!i[n]){if(!o[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(c)return c(n,!0);throw(t=new Error("Cannot find module '"+n+"'")).code="MODULE_NOT_FOUND",t}t=i[n]={exports:{}},o[n][0].call(t.exports,function(e){return s(o[n][1][e]||e)},t,t.exports,r,o,i,u)}return i[n].exports}for(var c="function"==typeof require&&require,e=0;e<u.length;e++)s(u[e]);return s}({1:[function(e,n,t){"use strict";var s=function(){return(s=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=(o.of=function(e){return new o(e)},o.prototype.setMode=function(e){return this.mode=e,this},o.prototype.getMode=function(){return this.mode},o.prototype.transaction=function(e){return this.db.transaction([e],this.getMode())},o.prototype.requestStore=function(){var e=this.name;return this.transaction(e).objectStore(e)},o.prototype.insert=function(i){var u=this;return new Promise(function(e,n){var t=u.requestStore().add(i),r=function(){e({msg:"add one record successfully!",status:!0}),t.removeEventListener("success",r),t.removeEventListener("error",o)},o=function(){n({msg:"add one record failed!",status:!1,activedRequest:t})};t.addEventListener("success",r),t.addEventListener("error",o)})},o.prototype.update=function(e,i){var u=this;return new Promise(function(r,o){e.index,e.value;u.getByIndex(e).then(function(e){if(!e.length)return console.warn("not found this record");for(var n=0,t=e;n<t.length;n++)!function(e){var n=u.requestStore(),e=s(s({},e),i),t=n.put(e);t.onsuccess=function(){r({msg:"update successfully!",status:!0})},t.onerror=function(){o({msg:"update failed!",status:!1,activedRequest:t})}}(t[n])})})},o.prototype.getByPrimaryKey=function(r){var o=this;return new Promise(function(e,n){var t=o.requestStore().get(r);t.onsuccess=function(){e(t.result)},t.onerror=function(){n({msg:"not found this primary key!",status:!1,activedRequest:t})}})},o.prototype.getByIndex=function(e){var r=this,o=e.index,i=e.value;return new Promise(function(e,n){var t=r.requestStore().index(o).getAll(i);t.onsuccess=function(){t.result.length?e(t.result):console.warn("not find record!")},t.onerror=function(){n({msg:"not found this index!",status:!1,activedRequest:t})}})},o.prototype.getAll=function(){var r=this;return new Promise(function(e,n){var t=r.requestStore().getAll();t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.result)}})},o.prototype.some=function(e){var u=this,s=e.index,c=e.lower,a=e.upper;return new Promise(function(n,e){var t=[],r=u.requestStore().index(s),o=IDBKeyRange.bound(c,a),i=r.openCursor(o);i.onsuccess=function(){var e=i.result;e?(t.push(e.value),e.continue()):n(t)},i.onerror=function(){e(i.error)}})},o.prototype.deleteRecord=function(e){var c=this;return new Promise(function(u,s){c.getByIndex(e).then(function(e){if(!e.length)return console.warn("not find this record");for(var n=0,t=e;n<t.length;n++){var r=t[n],o=c.requestStore(),i=o.keyPath,i=o.delete(r[i]);i.onsuccess=function(){u({msg:"delete successfully!",status:!0})},i.onerror=function(){s({msg:"delete failed!",status:!1})}}})})},o.prototype.clear=function(){var r=this;return new Promise(function(e,n){var t=r.requestStore().clear();t.onsuccess=function(){e({msg:"clear successfully!",status:!0})},t.onerror=function(){n({msg:"clear failed!",status:!1,activedRequest:t})}})},o.prototype.destroyed=function(){this.db=void 0,this.name=""},o);function o(e){this.mode="readwrite";var n=e.name,e=e.db;this.name=n,this.db=e}t.default=r},{}],2:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=e("./Table"),c=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,e=(r.of=function(){return new r},r.prototype.setup=function(e){e=e.dbName;return this.dbName=e,this},r.prototype.getVersion=function(){return this.version||1},r.prototype.setVersion=function(e){return this.version=e,this},r.prototype.upgrade=function(e,n){this.setVersion(e.version),this.db=e;for(var t=0,r=n;t<r.length;t++){var o=r[t];if(!e.objectStoreNames.contains(o.name)){var i=e.createObjectStore(o.name,{keyPath:o.primaryKey,autoIncrement:!!o.autoIncrement});if(o.indexs&&0!==o.indexs.length)for(var u=0,s=o.indexs;u<s.length;u++){var c=s[u];this.createIndex(i,{index:c.index,relativeIndex:c.relativeIndex,unique:c.unique})}}}},r.prototype.createIndex=function(e,n){e.createIndex(n.index,n.relativeIndex,{unique:n.unique})},r.prototype.createTable=function(e){var t=this;void 0===e&&(e=void 0);var n=this.dbName;if(void 0===e)return console.error("database table config must a list");var r=c.open(n,this.getVersion()),o=function(){t.upgrade(r.result,e),r.removeEventListener("upgradeneeded",o)};return r.addEventListener("upgradeneeded",o),new Promise(function(e,n){t.connect(r).then(function(n){function t(e){console.log("versionchange"),n.close(),n.removeEventListener("versionchange",t)}n.addEventListener("versionchange",t)})})},r.prototype.deleteDatabase=function(e){var t=c.deleteDatabase(e);return new Promise(function(e,n){t.onsuccess=function(){console.log(222);e({msg:"Database deleted successfully",status:!0})},t.onerror=function(){n({msg:"Database deleted failed",status:!0,activedRequest:t})}})},r.prototype.connect=function(i,u){return new Promise(function(e,n){function t(){i.removeEventListener("success",r),i.removeEventListener("error",o)}var r=function(){u&&u.successfully&&u.successfully(i),e(i.result),t()},o=function(){u&&u.error&&u.error(i),n(i.error),t()};i.addEventListener("success",r),i.addEventListener("error",o),i.addEventListener("blocked",function(){u&&u.blocked&&u.blocked(i),console.log("connect blocked")})})},r.prototype.insert=function(r,o){var i=this;return new Promise(function(n,t){var e=c.open(i.dbName,i.getVersion());i.connect(e).then(function(e){s.default.of({name:r,db:e}).insert(o).then(function(e){return n(e)}).catch(function(e){return t(e)})})})},r.prototype.updateRecord=function(r,o,i){var u=this;return new Promise(function(n,t){var e=c.open(u.dbName,u.getVersion());u.connect(e).then(function(e){s.default.of({name:r,db:e}).update(o,i).then(function(e){return n(e)}).catch(function(e){return t(e)})})})},r.prototype.getAll=function(r){var o=this;return new Promise(function(n,t){var e=c.open(o.dbName,o.getVersion());o.connect(e).then(function(e){s.default.of({name:r,db:e}).getAll().then(function(e){return n(e)}).catch(function(e){return t(e)})})})},r.prototype.getByPrimaryKey=function(r,o){var i=this;return new Promise(function(n,t){var e=c.open(i.dbName,i.getVersion());i.connect(e).then(function(e){s.default.of({name:r,db:e}).getByPrimaryKey(o).then(function(e){return n(e)}).catch(function(e){return t(e)})})})},r.prototype.getByIndex=function(r,o){var i=this;return new Promise(function(n,t){var e=c.open(i.dbName,i.getVersion());i.connect(e).then(function(e){s.default.of({name:r,db:e}).getByIndex(o).then(function(e){return n(e)}).catch(function(e){return t(e)})})})},r.prototype.deleteRecord=function(r,o){var i=this;return new Promise(function(n,t){var e=c.open(i.dbName,i.getVersion());i.connect(e).then(function(e){s.default.of({name:r,db:e}).deleteRecord(o).then(function(e){return n(e)}).catch(function(e){return t(e)})})})},r.prototype.deleteTable=function(r){var o=this;return new Promise(function(e,n){var t=c.open(o.dbName,o.getVersion());t.onupgradeneeded=function(e){var n=t.result;o.db=n,o.setVersion(n.version),e.oldVersion<o.getVersion()&&n.deleteObjectStore(r)},t.onsuccess=function(){console.log(o),e({msg:" deleted table successfully!"})},t.onerror=function(){n({msg:" deleted table failed!"})}})},r.prototype.some=function(r,o){var i=this;return new Promise(function(n,t){var e=c.open(i.dbName,i.getVersion());i.connect(e).then(function(e){s.default.of({name:r,db:e}).some(o).then(function(e){return n(e)}).catch(function(e){return t(e)})})})},r.prototype.clearTableRecord=function(r){var o=this;return new Promise(function(n,t){var e=c.open(o.dbName,o.getVersion());o.connect(e).then(function(e){s.default.of({name:r,db:e}).clear().then(function(e){return n(e)}).catch(function(e){return t(e)})})})},r);function r(){}t.default=e},{"./Table":1}],3:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TinyDB=void 0;e=e("./TinyDB");t.TinyDB=e.default,window.TinyDB=e.default},{"./TinyDB":2}]},{},[3]);